<!DOCTYPE html>
<html>
<head>
    <title>ê°„í¸ ê°€ê³„ë¶€</title>
    <style>
        body { padding: 30px; font-family: sans-serif; }
        .container { display: flex; gap: 30px; }
        .box { border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border-bottom: 1px solid #eee; padding: 8px; text-align: left; }
        button { cursor: pointer; }
    </style>
</head>
<body>
    <h2>ğŸ’° ë‚˜ì˜ ê±°ë˜ ë‚´ì—­ ({{ user.username }})</h2>

    <div style="margin-bottom: 20px; background: #f9f9f9; padding: 10px; border-radius: 5px;">
        <form method="GET">
            <label>ê²€ìƒ‰: </label>
            <select name="type">
                <option value="">ëª¨ë‘ ë³´ê¸°</option>
                <option value="INCOME">ìˆ˜ì…</option>
                <option value="EXPENSE">ì§€ì¶œ</option>
            </select>
            <input type="text" name="q" placeholder="ë‚´ìš© ê²€ìƒ‰...">
            <button type="submit">ì¡°íšŒ</button>
            <a href="/">[ì´ˆê¸°í™”]</a>
        </form>
    </div>

    <div class="container">
        <div class="box" style="flex: 1;">
            <h3>ğŸ“ ë‚´ì—­ ì¶”ê°€</h3>
            <form method="POST">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit" style="width: 100%; padding: 10px; background: black; color: white; border: none;">ì €ì¥í•˜ê¸°</button>
            </form>
        </div>

        <div class="box" style="flex: 2;">
            <h3>ğŸ“‹ ëª©ë¡</h3>
            <table>
                <thead>
                    <tr>
                        <th>ë‚ ì§œ</th>
                        <th>êµ¬ë¶„</th>
                        <th>ë¶„ë¥˜</th>
                        <th>ë‚´ìš©</th>
                        <th>ê¸ˆì•¡</th>
                        <th>ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody>
                    {% for t in transactions %}
                    <tr>
                        <td>{{ t.transaction_at|date:"Y-m-d" }}</td>
                        <td style="color: {% if t.type == 'INCOME' %}blue{% else %}red{% endif %}">
                            {{ t.get_type_display }}
                        </td>
                        <td>{{ t.category }}</td>
                        <td>{{ t.memo }}</td>
                        <td>{{ t.amount }}ì›</td>
                        <td>
                            <form action="{% url 'transaction_delete' t.pk %}" method="POST" style="margin:0;">
                                {% csrf_token %}
                                <button type="submit" onclick="return confirm('ì •ë§ ì‚­ì œí• ê¹Œìš”?')">ì‚­ì œ</button>
                            </form>
                        </td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="6" style="text-align:center; color:gray;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>