{% extends "base.html" %}
{% load humanize %}

{% block content %}

<div class="row justify-content-center">
  <div class="col-12 col-lg-8">

    <!-- 상단 타이틀 / 버튼 -->
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="mb-0">{{ request.user.username }} 님의 가계부</h2>
      <a href="{% url 'transactions:transaction_create' %}" class="btn btn-dark btn-sm">
        + 새 거래
      </a>
    </div>

    <!-- 메인에서 보여줄  -->
    {% comment %} 최근 거래 목록 {% endcomment %}
    {% if recent_transactions %}
      <ul class="list-group">
        {% for t in recent_transactions %}
          <li class="list-group-item border-0 border-bottom py-2 px-0">
            <a href="{% url 'transactions:transaction_detail' t.id %}"
               class="d-block text-decoration-none text-body">

              <div class="d-flex justify-content-between">
                <div class="fw-semibold">
                  {{ t.get_category_display }}
                  {% if t.memo %} · {{ t.memo }}{% endif %}
                </div>
                <div class="fw-bold {% if t.type == 'withdraw' %}text-danger{% else %}text-primary{% endif %}">
                  {% if t.type == "withdraw" %}-{% else %}+{% endif %}
                  {{ t.amount|intcomma }}원
                </div>
              </div>

              <div class="text-muted small d-flex justify-content-between mt-1">
                <span>{{ t.transacted_at|date:"Y-m-d H:i" }}</span>
                <span>{{ t.account.nickname|default:t.account }}</span>
              </div>

            </a>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-muted">최근 거래가 없습니다.</p>
    {% endif %}

    <div class="text-center mt-3">
      <a href="{% url 'transactions:transaction_html' %}" class="btn btn-outline-secondary btn-sm">
        전체 거래 보기
      </a>
    </div>

  </div>
</div>

{% endblock %}
